<div class="p-8 min-h-screen bg-base-200">
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold text-base-content">GestiÃ³n de Usuarios</h1>
    <button (click)="loadRequests()" class="btn btn-ghost btn-sm">ðŸ”„ Recargar</button>
  </div>

  @if (isLoading) {
    <div class="flex justify-center">
      <span class="loading loading-spinner loading-lg"></span>
    </div>
  } @else {
    
    <div class="overflow-x-auto bg-base-100 shadow-xl rounded-lg">
      <table class="table">
        <thead class="bg-base-300 text-base-content">
          <tr>
            <th>Usuario</th>
            <th class="text-center">Rol Actual</th>
            <th class="text-center">Asignar Rol</th>
          </tr>
        </thead>
        
        <tbody>
          @for (user of allUsers; track user.uid) {
            <tr class="hover">
              
              <td>
                <div class="flex items-center gap-3">
                  <div class="avatar">
                    <div class="mask mask-squircle w-12 h-12">
                      <img [src]="user.photoURL || 'https://ui-avatars.com/api/?name='+user.email" />
                    </div>
                  </div>
                  <div>
                    <div class="font-bold">{{ user.displayName || 'Sin nombre' }}</div>
                    <div class="text-sm opacity-50">{{ user.email }}</div>
                  </div>
                </div>
              </td>

              <td class="text-center">
                @if (user.role === 'admin') {
                  <span class="badge badge-error text-white font-bold">ADMIN ðŸ‘‘</span>
                } @else if (user.role === 'programmer') {
                  <span class="badge badge-primary text-white">DEV ðŸ’»</span>
                } @else {
                  <span class="badge badge-ghost">Usuario</span>
                }
              </td>

              <td class="flex justify-center gap-2">
                
                <button 
                  (click)="cambiarRol(user, 'user')" 
                  class="btn btn-xs btn-ghost border-gray-300"
                  [disabled]="user.role === 'user'"
                  title="Degradar a Usuario">
                  ðŸ‘¤
                </button>

                <button 
                  (click)="cambiarRol(user, 'programmer')" 
                  class="btn btn-xs btn-primary text-white"
                  [disabled]="user.role === 'programmer'"
                  title="Ascender a Programador">
                  ðŸ’» Dev
                </button>

                <button 
                  (click)="cambiarRol(user, 'admin')" 
                  class="btn btn-xs btn-error text-white"
                  [disabled]="user.role === 'admin'"
                  title="Hacer Admin">
                  ðŸ‘‘ Admin
                </button>

                <button 
                  (click)="eliminarUsuario(user)" 
                  class="btn btn-xs btn-outline btn-error"
                  title="Eliminar Usuario permanentemente">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                </button>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</div>