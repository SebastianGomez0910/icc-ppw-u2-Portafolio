<div class="min-h-screen bg-base-200 p-4 md:p-10">
  <h1 class="text-3xl font-bold text-primary mb-8 text-center"> Mis Solicitudes de Asesoría</h1>

  @if (isLoading) {
    <div class="flex justify-center mt-10">
      <span class="loading loading-spinner loading-lg text-primary"></span>
    </div>
  } 
  
  @else if (myAppointments.length === 0) {
    <div class="text-center mt-10 opacity-60">
      <p class="text-xl">No tienes citas agendadas todavía.</p>
      <a routerLink="/book-appointment" class="btn btn-link">Ir a buscar un experto</a>
    </div>
  } 
  
  @else {
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-6xl mx-auto">
      
      @for (cita of myAppointments; track cita.id) {
        <article class="card bg-base-100 shadow-xl border-l-8 transition-all hover:scale-[1.02]"
                 [ngClass]="{
                   'border-l-success': cita.status === 'ACCEPTED',
                   'border-l-error': cita.status === 'REJECTED',
                   'border-l-warning': cita.status === 'PENDING' || !cita.status
                 }">
          <div class="card-body">
            
            <div class="flex justify-between items-start mb-2">
              <h2 class="card-title text-lg font-bold">
                 {{ cita.topic || 'Asesoría General' }}
              </h2>
              <span class="badge font-bold p-3 uppercase text-xs" 
                    [ngClass]="getStatusClass(cita.status)">
                {{ translateStatus(cita.status) }}
              </span>
            </div>

            <div class="text-sm text-gray-500 space-y-2 mb-4 bg-base-200 p-3 rounded-lg">
              <p class="flex items-center gap-2">
                 {{ cita.schedule?.date }}
              </p>
              <p class="flex items-center gap-2">
                 {{ cita.schedule?.startTime }}
              </p>
              <p class="flex items-center gap-2">
                 Experto: <span class="font-semibold text-primary">{{ cita.schedule?.user?.name || 'Asesor' }}</span>
              </p>
            </div>

            @if (cita.status === 'ACCEPTED') {
              <div class="alert alert-success shadow-sm text-white text-xs">
                <span>¡Tu cita ha sido confirmada! Te esperamos.</span>
              </div>
            }

            @if (cita.status === 'REJECTED') {
              <div class="alert alert-error shadow-sm text-white text-xs">
                <span>Lo sentimos, el experto no puede atenderte en este horario.</span>
              </div>
            }

          </div>
        </article>
      }

    </div>
  }
</div>